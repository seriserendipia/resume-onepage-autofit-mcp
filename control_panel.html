<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="UTF-8">
  <title>Resume Control Panel / ç®€å†æ§åˆ¶é¢æ¿</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background: linear-gradient(135deg,#b2ebf2 0%, #e0f7fa 40%, #fce4ec 100%);
    }
    #lang-toggle {
      position: fixed;
      top: 10px;
      right: 10px;
      background: #fff;
      z-index: 1001;
      padding: 6px 12px;
      border-radius: 4px;
      box-shadow: 0 2px 8px #ccc;
      cursor: pointer;
      font-size: 12px;
      border: 1px solid #ddd;
    }
    #lang-toggle:hover {
      background: #f0f0f0;
    }
    #controls {
      position: fixed;
      bottom: 10px;
      right: 10px;
      background: #fff;
      z-index: 1000;
      padding: 16px;
      border-radius: 8px;
      box-shadow: 0 2px 8px #ccc;
    }
    iframe {
      width: 100%;
      height: 90vh;
      border: 1px solid #ccc;
      border-radius: 8px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
    }
    th, td {
      padding: 8px;
      text-align: left;
    }
    th {
      background-color: #f2f2f2;
    }
    .slider-wrapper {
      display: flex;
      align-items: center;
      gap: 5px;
    }
    .limit-btn {
      width: 24px;
      height: 24px;
      padding: 0;
      font-size: 10px;
      line-height: 24px;
      text-align: center;
      cursor: pointer;
      border: 1px solid #ccc;
      background: #f8f9fa;
      border-radius: 4px;
    }
    .limit-btn:hover {
      background: #e2e6ea;
    }
  </style>
</head>
<body>
  <!-- Language Toggle Button -->
  <button id="lang-toggle" onclick="toggleLanguage()">ğŸŒ EN / ä¸­æ–‡</button>

  <div id="controls">
    <table>
      <thead>
        <tr>
          <th data-i18n="feature">åŠŸèƒ½</th>
          <th data-i18n="slider">æ»‘æ†</th>
          <th data-i18n="value">å½“å‰å€¼</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td data-i18n="fontSize">æ­£æ–‡å­—ä½“å¤§å°</td>
          <td>
            <div class="slider-wrapper">
               <button class="limit-btn min-btn" title="æœ€å°å€¼">L</button>
               <input type="range" id="fontSlider" min="9" max="13" step="0.5" value="9">
               <button class="limit-btn max-btn" title="æœ€å¤§å€¼">H</button>
            </div>
          </td>
          <td><span id="fontValue">9pt</span></td>
        </tr>
        <tr>
          <td data-i18n="headingScale">æ ‡é¢˜æ¯”ä¾‹</td>
          <td>
            <div class="slider-wrapper">
               <button class="limit-btn min-btn" title="æœ€å°å€¼">L</button>
               <input type="range" id="headingSlider" min="1.0" max="1.7" step="0.1" value="1.7">
               <button class="limit-btn max-btn" title="æœ€å¤§å€¼">H</button>
            </div>
          </td>
          <td><span id="headingValue">1.7å€</span></td>
        </tr>
        <tr>
          <td data-i18n="lineHeight">è¡Œé—´è·</td>
          <td>
            <div class="slider-wrapper">
               <button class="limit-btn min-btn" title="æœ€å°å€¼">L</button>
               <input type="range" id="lineHeightSlider" min="1" max="1.7" step="0.05" value="1.45">
               <button class="limit-btn max-btn" title="æœ€å¤§å€¼">H</button>
            </div>
          </td>
          <td><span id="lineHeightValue">1.45å€</span></td>
        </tr>
        <tr>
          <td data-i18n="pageMargin">é¡µé¢è¾¹è·</td>
          <td>
            <div class="slider-wrapper">
               <button class="limit-btn min-btn" title="æœ€å°å€¼">L</button>
               <input type="range" id="marginSlider" min="7" max="21" step="1" value="7">
               <button class="limit-btn max-btn" title="æœ€å¤§å€¼">H</button>
            </div>
          </td>
          <td><span id="marginValue">7 mm</span></td>
        </tr>
        
        <!-- Global Margins/Padding removed as they are redundant for specific margin controls -->

        <tr>
          <td data-i18n="titleHrMargin">æ ‡é¢˜/åˆ†å‰²çº¿é—´è·</td>
          <td>
            <div class="slider-wrapper">
               <button class="limit-btn min-btn" title="æœ€å°å€¼">L</button>
               <input type="range" id="titleHrMarginSlider" min="0" max="0.7" step="0.1" value="0">
               <button class="limit-btn max-btn" title="æœ€å¤§å€¼">H</button>
            </div>
          </td>
          <td><span id="titleHrMarginValue">0 em</span></td>
        </tr>
        <tr>
          <td data-i18n="bodyMargin">æ®µè½é—´è·</td>
          <td>
            <div class="slider-wrapper">
               <button class="limit-btn min-btn" title="æœ€å°å€¼">L</button>
               <input type="range" id="bodyMarginSlider" min="0" max="0.5" step="0.1" value="0.5">
               <button class="limit-btn max-btn" title="æœ€å¤§å€¼">H</button>
            </div>
          </td>
          <td><span id="bodyMarginValue">0.5 em</span></td>
        </tr>
        <tr>
          <td data-i18n="ulMargin">åˆ—è¡¨é—´è·</td>
          <td>
            <div class="slider-wrapper">
               <button class="limit-btn min-btn" title="æœ€å°å€¼">L</button>
               <input type="range" id="ulMarginSlider" min="0" max="0.5" step="0.1" value="0">
               <button class="limit-btn max-btn" title="æœ€å¤§å€¼">H</button>
            </div>
          </td>
          <td><span id="ulMarginValue">0 em</span></td>
        </tr>
        <tr>
          <td data-i18n="strongParagraphMargin">å¼ºè°ƒæ®µè½é—´è·</td>
          <td>
            <div class="slider-wrapper">
               <button class="limit-btn min-btn" title="æœ€å°å€¼">L</button>
               <input type="range" id="strongParagraphMarginSlider" min="0" max="0.2" step="0.1" value="0.2">
               <button class="limit-btn max-btn" title="æœ€å¤§å€¼">H</button>
            </div>
          </td>
          <td><span id="strongParagraphMarginValue">0.2 em</span></td>
        </tr>
      </tbody>
    </table>
    <button id="setDefaultButton" data-i18n="setDefault">è®¾ä¸ºé»˜è®¤å€¼</button>
    <!-- Print/Export button -->
    <button id="printButton" data-i18n="exportPdf">å¯¼å‡ºä¸º PDF</button>
  </div>

  <iframe id="innerFrame" src="resume_preview.html"></iframe>

  <!-- å¼•å…¥æ¨¡å—åŒ–JSæ–‡ä»¶ - åªç”¨äºå¤–å±‚æ§åˆ¶ -->
  <!-- çŠ¶æ€ç®¡ç†ç³»ç»Ÿ -->
  <script src="js/resumeStateManager.js"></script>
  <script src="js/pagedJsMiddleware.js"></script>
  <script src="js/domUpdater.js"></script>
  <!-- åŸæœ‰æ¨¡å— -->
  <script src="js/config.js"></script>
  <script src="js/styleController.js"></script>
  <script src="js/sliderController.js"></script>
  <script src="js/controller.js"></script>
  
  <!-- åˆå§‹åŒ–å¤–å±‚æ§åˆ¶å™¨ -->
  <script>
    // i18n translations
    const i18n = {
      zh: {
        feature: 'åŠŸèƒ½',
        slider: 'æ»‘æ†',
        value: 'å½“å‰å€¼',
        fontSize: 'æ­£æ–‡å­—ä½“å¤§å°',
        headingScale: 'æ ‡é¢˜æ¯”ä¾‹',
        lineHeight: 'è¡Œé—´è·',
        pageMargin: 'é¡µé¢è¾¹è·',
        titleHrMargin: 'æ ‡é¢˜/åˆ†å‰²çº¿é—´è·',
        bodyMargin: 'æ®µè½é—´è·',
        ulMargin: 'åˆ—è¡¨é—´è·',
        strongParagraphMargin: 'å¼ºè°ƒæ®µè½é—´è·',
        setDefault: 'è®¾ä¸ºé»˜è®¤å€¼',
        exportPdf: 'å¯¼å‡ºä¸º PDF',
        minValue: 'æœ€å°å€¼',
        maxValue: 'æœ€å¤§å€¼',
        times: 'å€'
      },
      en: {
        feature: 'Feature',
        slider: 'Slider',
        value: 'Value',
        fontSize: 'Font Size',
        headingScale: 'Heading Scale',
        lineHeight: 'Line Height',
        pageMargin: 'Page Margin',
        titleHrMargin: 'Title/HR Margin',
        bodyMargin: 'Paragraph Margin',
        ulMargin: 'List Margin',
        strongParagraphMargin: 'Emphasis Margin',
        setDefault: 'Set as Default',
        exportPdf: 'Export to PDF',
        minValue: 'Minimum',
        maxValue: 'Maximum',
        times: 'x'
      }
    };

    let currentLang = localStorage.getItem('resumeLang') || 'zh';

    function applyLanguage(lang) {
      currentLang = lang;
      localStorage.setItem('resumeLang', lang);
      document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (i18n[lang][key]) {
          el.textContent = i18n[lang][key];
        }
      });
      // Update slider button titles
      document.querySelectorAll('.min-btn').forEach(btn => {
        btn.title = i18n[lang].minValue;
      });
      document.querySelectorAll('.max-btn').forEach(btn => {
        btn.title = i18n[lang].maxValue;
      });
      // Update document title
      document.title = lang === 'zh' ? 'ç®€å†æ§åˆ¶é¢æ¿' : 'Resume Control Panel';
      // Refresh slider display values (translate units like "å€" -> "x")
      if (window.resumeController && window.resumeController.sliderController && 
          window.resumeController.sliderController.refreshAllDisplayValues) {
        window.resumeController.sliderController.refreshAllDisplayValues();
      }
    }

    function toggleLanguage() {
      applyLanguage(currentLang === 'zh' ? 'en' : 'zh');
    }

    // ç­‰å¾…DOMåŠ è½½å®Œæˆååˆå§‹åŒ–å¤–å±‚æ§åˆ¶å™¨
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', () => {
        initializeResumeController();
        applyLanguage(currentLang);
      });
    } else {
      initializeResumeController();
      applyLanguage(currentLang);
    }
  </script>
</body>
</html>
